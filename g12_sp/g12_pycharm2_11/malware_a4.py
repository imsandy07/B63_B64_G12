import os

FILE_SIGNATURES = {
    "504B0304": ("ZIP Archive", ".zip"),
    "89504E47": ("PNG Image", ".png"),
    "D0CF11E0": ("Microsoft Office Document (Pre-2007)", ".doc"),
    "3C21444F": ("HTML File", ".html"),
    "49443303": ("MP3 Audio File", ".mp3"),
    "25504446": ("PDF Document", ".pdf"),
    "47494638": ("GIF Image", ".gif"),
    "3026B275": ("Windows Media File (ASF)", ".wmv"),
    "00000018": ("MP4 Video File", ".mp4"),
    "52617221": ("RAR Archive", ".rar"),
}


def read_file_signature(file_path, num_bytes=8):
    with open(file_path, "rb") as f:
        return f.read(num_bytes).hex().upper()


def identify_file_type(hex_signature):
    for sig, (file_type, extension) in FILE_SIGNATURES.items():
        if hex_signature.startswith(sig):
            return file_type, extension
    return "Unknown", "Unknown"


FILES_DIR = "Files for Signature"

if os.path.exists(FILES_DIR):
    print("Analyzing files in:", FILES_DIR)

    for filename in os.listdir(FILES_DIR):
        file_path = os.path.join(FILES_DIR, filename)

        if filename.startswith("."):
            continue

        hex_sig = read_file_signature(file_path)
        file_type, extension = identify_file_type(hex_sig)

        if extension != "Unknown":
            new_file_path = os.path.join(FILES_DIR, filename + extension)
            os.rename(file_path, new_file_path)
            print(f"Renamed: {filename} â†’ {filename + extension} ({file_type})")
        else:
            print(f"Unknown file type: {filename} (Signature: {hex_sig})")

print("File analysis and renaming completed.")
